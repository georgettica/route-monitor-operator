apiVersion: v1
kind: Template
parameters:
- name: REGISTRY_IMG
  required: true
- name: CHANNEL
  required: true
- name: IMAGE_TAG
  required: true
- name: REPO_NAME
  value: route-monitor-operator
  required: true
metadata:
  name: selectorsyncset-template
objects:
- apiVersion: hive.openshift.io/v1
  kind: SelectorSyncSet
  metadata:
    labels:
      managed.openshift.io/gitHash: ${IMAGE_TAG}
      managed.openshift.io/gitRepoName: ${REPO_NAME}
      managed.openshift.io/osd: 'true'
    name: bundle-manifests
  spec:
    clusterDeploymentSelector:
      matchLabels:
        api.openshift.com/managed: 'true'
    resourceApplyMode: Sync
    resources:
    - apiVersion: monitoring.coreos.com/v1
      kind: ServiceMonitor
      metadata:
        labels:
          control-plane: controller-manager
        name: controller-manager-metrics-monitor
      spec:
        endpoints:
        - path: /metrics
          port: https
        selector:
          matchLabels:
            control-plane: controller-manager
    - apiVersion: apiextensions.k8s.io/v1beta1
      kind: CustomResourceDefinition
      metadata:
        annotations:
          controller-gen.kubebuilder.io/version: v0.3.0
        creationTimestamp: null
        name: clusterurlmonitors.monitoring.openshift.io
      spec:
        group: monitoring.openshift.io
        names:
          kind: ClusterUrlMonitor
          listKind: ClusterUrlMonitorList
          plural: clusterurlmonitors
          singular: clusterurlmonitor
        scope: Namespaced
        subresources:
          status: {}
        validation:
          openAPIV3Schema:
            description: ClusterUrlMonitor is the Schema for the clusterurlmonitors
              API
            properties:
              apiVersion:
                description: 'APIVersion defines the versioned schema of this representation
                  of an object. Servers should convert recognized schemas to the latest
                  internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
                type: string
              kind:
                description: 'Kind is a string value representing the REST resource
                  this object represents. Servers may infer this from the endpoint
                  the client submits requests to. Cannot be updated. In CamelCase.
                  More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
                type: string
              metadata:
                type: object
              spec:
                description: ClusterUrlMonitorSpec defines the desired state of ClusterUrlMonitor
                properties:
                  port:
                    type: string
                  prefix:
                    description: Foo is an example field of ClusterUrlMonitor. Edit
                      ClusterUrlMonitor_types.go to remove/update
                    type: string
                  suffix:
                    type: string
                type: object
              status:
                description: ClusterUrlMonitorStatus defines the observed state of
                  ClusterUrlMonitor
                type: object
            type: object
        version: v1alpha1
        versions:
        - name: v1alpha1
          served: true
          storage: true
      status:
        acceptedNames:
          kind: ''
          plural: ''
        conditions: []
        storedVersions: []
    - apiVersion: apiextensions.k8s.io/v1beta1
      kind: CustomResourceDefinition
      metadata:
        annotations:
          controller-gen.kubebuilder.io/version: v0.3.0
        creationTimestamp: null
        name: routemonitors.monitoring.openshift.io
      spec:
        group: monitoring.openshift.io
        names:
          kind: RouteMonitor
          listKind: RouteMonitorList
          plural: routemonitors
          singular: routemonitor
        scope: Namespaced
        subresources:
          status: {}
        validation:
          openAPIV3Schema:
            description: RouteMonitor is the Schema for the routemonitors API
            properties:
              apiVersion:
                description: 'APIVersion defines the versioned schema of this representation
                  of an object. Servers should convert recognized schemas to the latest
                  internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
                type: string
              kind:
                description: 'Kind is a string value representing the REST resource
                  this object represents. Servers may infer this from the endpoint
                  the client submits requests to. Cannot be updated. In CamelCase.
                  More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
                type: string
              metadata:
                type: object
              spec:
                description: RouteMonitorSpec defines the desired state of RouteMonitor
                properties:
                  route:
                    description: Route is the resource that holds the name and Namespace
                      of the Route to monitor
                    properties:
                      name:
                        description: Name is the name of the Route
                        type: string
                      namespace:
                        description: Namespace is the namespace of the Route
                        type: string
                    type: object
                type: object
              status:
                description: RouteMonitorStatus defines the observed state of RouteMonitor
                properties:
                  routeURL:
                    description: RouteURL is the url extracted from the Route resource
                    type: string
                type: object
            type: object
        version: v1alpha1
        versions:
        - name: v1alpha1
          served: true
          storage: true
      status:
        acceptedNames:
          kind: ''
          plural: ''
        conditions: []
        storedVersions: []
    - apiVersion: v1
      kind: Service
      metadata:
        creationTimestamp: null
        labels:
          control-plane: controller-manager
        name: route-monitor-operator-cmms
      spec:
        ports:
        - name: https
          port: 8443
          targetPort: https
        selector:
          control-plane: controller-manager
      status:
        loadBalancer: {}
    - apiVersion: rbac.authorization.k8s.io/v1beta1
      kind: ClusterRole
      metadata:
        creationTimestamp: null
        name: route-monitor-operator-metrics-reader
      rules:
      - nonResourceURLs:
        - /metrics
        verbs:
        - get
    - apiVersion: operators.coreos.com/v1alpha1
      kind: ClusterServiceVersion
      metadata:
        annotations:
          alm-examples: '[]'
          capabilities: Basic Install
          operators.operatorframework.io/builder: operator-sdk-v1.2.0
          operators.operatorframework.io/project_layout: go.kubebuilder.io/v2
        name: route-monitor-operator.v0.1.126-c3bf622
        namespace: placeholder
      spec:
        apiservicedefinitions: {}
        customresourcedefinitions:
          owned:
          - description: ClusterUrlMonitor is the Schema for the clusterurlmonitors
              API
            displayName: Cluster Url Monitor
            kind: ClusterUrlMonitor
            name: clusterurlmonitors.monitoring.openshift.io
            version: v1alpha1
          - description: RouteMonitor is the Schema for the routemonitors API
            displayName: Route Monitor
            kind: RouteMonitor
            name: routemonitors.monitoring.openshift.io
            version: v1alpha1
        description: Automatically enables blackbox probes for routes on OpenShift
          clusters to be consumed by the Cluster Monitoring Operator or any vanilla
          Prometheus Operator
        displayName: Route Monitor Operator
        icon:
        - base64data: ''
          mediatype: ''
        install:
          spec:
            clusterPermissions:
            - rules:
              - apiGroups:
                - '*'
                resources:
                - services
                verbs:
                - create
                - delete
                - get
                - list
                - watch
              - apiGroups:
                - apps
                resources:
                - deployments
                verbs:
                - create
                - delete
                - get
                - list
                - watch
              - apiGroups:
                - config.openshift.io
                resources:
                - ingresses
                verbs:
                - get
                - list
              - apiGroups:
                - monitoring.coreos.com
                resources:
                - servicemonitors
                verbs:
                - create
                - delete
                - get
                - list
                - watch
              - apiGroups:
                - monitoring.openshift.io
                resources:
                - clusterurlmonitors
                verbs:
                - create
                - delete
                - get
                - list
                - patch
                - update
                - watch
              - apiGroups:
                - monitoring.openshift.io
                resources:
                - clusterurlmonitors/status
                verbs:
                - get
                - patch
                - update
              - apiGroups:
                - monitoring.openshift.io
                resources:
                - routemonitors
                verbs:
                - create
                - delete
                - get
                - list
                - patch
                - update
                - watch
              - apiGroups:
                - monitoring.openshift.io
                resources:
                - routemonitors/status
                verbs:
                - get
                - patch
                - update
              - apiGroups:
                - route.openshift.io
                resources:
                - routes
                verbs:
                - get
                - list
                - watch
              - apiGroups:
                - authentication.k8s.io
                resources:
                - tokenreviews
                verbs:
                - create
              - apiGroups:
                - authorization.k8s.io
                resources:
                - subjectaccessreviews
                verbs:
                - create
              serviceAccountName: route-monitor-operator-system
            deployments:
            - name: route-monitor-operator-controller-manager
              spec:
                replicas: 1
                selector:
                  matchLabels:
                    app: route-monitor-operator
                    component: operator
                    control-plane: controller-manager
                strategy: {}
                template:
                  metadata:
                    labels:
                      app: route-monitor-operator
                      component: operator
                      control-plane: controller-manager
                  spec:
                    containers:
                    - args:
                      - --secure-listen-address=0.0.0.0:8443
                      - --upstream=http://127.0.0.1:8080/
                      - --logtostderr=true
                      - --v=10
                      image: gcr.io/kubebuilder/kube-rbac-proxy:v0.5.0
                      name: kube-rbac-proxy
                      ports:
                      - containerPort: 8443
                        name: https
                      resources: {}
                    - args:
                      - --metrics-addr=127.0.0.1:8080
                      - --enable-leader-election
                      - --zap-log-level=$(LOG_LEVEL)
                      - --blackbox-image=$(BLACKBOX_IMAGE)
                      command:
                      - /manager
                      env:
                      - name: LOG_LEVEL
                        value: '1'
                      - name: BLACKBOX_IMAGE
                        value: quay.io/app-sre/prom-blackbox-exporter:master
                      image: route-monitor-operator:latest
                      name: manager
                      resources:
                        limits:
                          cpu: 100m
                          memory: 300Mi
                        requests:
                          cpu: 100m
                          memory: 20Mi
                    serviceAccountName: route-monitor-operator-system
                    terminationGracePeriodSeconds: 10
            permissions:
            - rules:
              - apiGroups:
                - ''
                resources:
                - configmaps
                verbs:
                - get
                - list
                - watch
                - create
                - update
                - patch
                - delete
              - apiGroups:
                - ''
                resources:
                - configmaps/status
                verbs:
                - get
                - update
                - patch
              - apiGroups:
                - ''
                resources:
                - events
                verbs:
                - create
                - patch
              serviceAccountName: route-monitor-operator-system
          strategy: deployment
        installModes:
        - supported: false
          type: OwnNamespace
        - supported: false
          type: SingleNamespace
        - supported: false
          type: MultiNamespace
        - supported: true
          type: AllNamespaces
        keywords:
        - operator-sdk
        - golang
        - monitoring
        - sre
        - openshift-dedicated
        - openshift
        - redhat
        links:
        - name: Route Monitor Operator
          url: https://github.com/openshift/route-monitor-operator/
        maintainers:
        - email: rrackow@redhat.com
          name: RiRa12621
        - email: 11993626+georgettica@users.noreply.github.com
          name: georgettica
        maturity: alpha
        provider:
          name: Red Hat
          url: https://www.redhat.com
        replaces: route-monitor-operator.v0.1.126-f78c5ca
        version: 0.1.126-c3bf622
